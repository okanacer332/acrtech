---
title: "Переработка текстиля - Международная ERP: Архитектура Multi-Tenant и RBAC"
category: "SaaS Architecture"
description: "Технический обзор системы управления с поддержкой мультиарендности и ролевого доступа, разработанной на Next.js и Spring Boot для глобальных текстильных операций. Данные для доступа ниже."
date: "2025-12-12"
image: "/portfolio/22.png"
---

# Интегрированная система управления с мультиарендностью (Multi-Tenant) и ролевым доступом (RBAC) в глобальной цепочке поставок текстиля

**Проект:** AJ International ERP

**URL доступа:** [app-tekstil.acrtech.com.tr](https://app-tekstil.acrtech.com.tr)

**Тип документа:** Статья о технической архитектуре и системном анализе

## Аннотация (Abstract)

В этой статье рассматривается облачная система планирования ресурсов предприятия (ERP), разработанная для операций AJ International, которая управляет географически распределенными (Турция, Россия, Дубай) бизнес-процессами через единое базовое программное обеспечение.

Исследование подробно описывает архитектуру «Multi-Tenant» (Мультиарендность), созданную с использованием гибридных технологий **Next.js 14**, **Spring Boot** и **MongoDB**, а также механизм RBAC (Role-Based Access Control), активно работающий в системе. Система представляет собой проверенное программное решение, работающее в реальной среде, которое обеспечивает изоляцию данных при сохранении возможностей централизованного управления.

## 1. Введение

Текстильный сектор требует сложной модели данных из-за вариативной структуры продукции (цвет, размер, тип ткани) и трансграничных логистических процессов.

Проект AJ International принял немонолитную, современную сервис-ориентированную архитектуру для управления этой сложностью. Система объединяет операции в Турции, России и Дубае, каждая из которых имеет свои собственные правовые и коммерческие правила, в инфраструктуре, которая логически разделена, но физически работает на едином кластере баз данных.

## 2. Системная архитектура и Технологический стек

Проект структурирован таким образом, что слои Frontend и Backend работают полностью независимо, в соответствии с принципом «Разделения ответственности» (Separation of Concerns).

### 2.1. Архитектура Frontend (Клиентский слой)

Пользовательский опыт построен на архитектуре **Next.js 14 (App Router)** благодаря возможности рендеринга на стороне сервера (SSR) и совместимости с SEO.

* **Библиотека компонентов:** С использованием Shadcn/ui и TailwindCSS были разработаны повторно используемые и легкие компоненты UI, соответствующие принципам атомарного дизайна.

* **Управление состоянием:** Сложные данные форм и информация о сессии пользователя управляются в глобальном состоянии с помощью библиотеки **Zustand**.

* **Получение данных:** Синхронизация данных между сервером и клиентом оптимизирована, а сетевые запросы минимизированы с помощью паттернов SWR или TanStack Query.

### 2.2. Архитектура Backend (Серверный слой)

Бизнес-логика (Business Logic) работает на **Spring Boot 3.x**, стандарте корпоративной экосистемы Java.

* **База данных:** **MongoDB (NoSQL)**. Иерархическая и переменная структура текстильных изделий (например, продукт имеет N вариантов цвета, и каждый вариант имеет M запасов размера) потребовала документоориентированной структуры вместо реляционных баз данных.

* **API Gateway:** Все запросы обслуживаются через конечные точки (endpoints), разработанные в соответствии со стандартами RESTful API.

## 3. Архитектура безопасности и Контроль доступа

Слой безопасности системы — это активная в настоящее время структура, охватывающая не только аутентификацию, но и детальную авторизацию.

### 3.1. Ролевой контроль доступа (RBAC)

В системе пользователи получают доступ к определенным ресурсам в соответствии с назначенными им ролями. Эта структура работает в цепочке фильтров Spring Security (Filter Chain) по следующей логике:

> Permission(u) = Union( Roles(u) -> Permissions(r) )

В системе активно применяется следующая иерархия:

* **Супер Админ (Root):** Полномочия управлять всеми арендаторами (странами) и конфигурациями.

* **Админ страны (Tenant Admin):** Управляет только пользователями, запасами и финансами в своей стране (например, TR, RU или DU). Не видит данные других стран.

* **Операционный пользователь:** Имеет полномочия только на ввод и просмотр данных; полномочия на удаление или настройку ограничены.

### 3.2. Аутентификация (JWT & HttpOnly)

Система имеет архитектуру «Stateless» (без сохранения состояния).

1.  Когда пользователь входит в систему, сервер генерирует подписанный **JWT (JSON Web Token)**.

2.  Этот токен хранится в **HttpOnly Cookie**, недоступном для JavaScript на стороне клиента. Этот метод обеспечивает полную защиту от атак XSS (Межсайтовый скриптинг).

## 4. Мультиарендность (Multi-Tenancy) и Изоляция данных

Система использует стратегию **«Столбец-дискриминатор»** (Discriminator Column), а не «База данных на схему» (Database-per-Schema), где один экземпляр программного обеспечения обслуживает несколько организаций.

* **Контекст арендатора:** Каждый HTTP-запрос перехватывается Интерцептором (Interceptor).

* **Фильтрация данных:** `tenant_id` (например, tr, ru, du) считывается из заголовка запроса (Header) или профиля вошедшего пользователя.

* **Запрос MongoDB:** Бэкенд автоматически добавляет критерий `{ tenant: "current_tenant" }` к каждому запросу, идущему к базе данных. Таким образом, технически невозможно, чтобы пользователь из России получил доступ к данным Турции путем манипулирования API.

## 5. Детали модулей и функций

Система AJ International состоит из следующих основных модулей, управляющих текстильными операциями от начала до конца:

### 5.1. Панель управления и Дашборд

Экран, с которым пользователь сталкивается первым, формируется динамически в соответствии с уровнем авторизации.

* **Карточки KPI:** Метрики, такие как общие продажи, активные заказы, критический уровень запасов, рассчитываются мгновенно.

* **Графический анализ:** Визуализируются тенденции продаж и распределение запасов.

### 5.2. Управление продуктами и инвентарем (PIM & WMS)

Этот модуль, сердце текстильного сектора, охватывает управление вариантами до мельчайших деталей.

* **Матрица вариантов:** Подкатегории (SKU), такие как Цвет, Размер, Тип ткани, управляются под одним Родительским продуктом (Parent Product).

* **Движение товаров:** Операции входа, выхода, перемещения и возврата логируются. Какой продукт находится на каком складе (Склад TR, Склад RU) и в каком количестве, отслеживается мгновенно.

### 5.3. Текущий счет и Отношения с клиентами (CRM)

Разработано для операций B2B.

* **Карточки клиентов:** Портфель клиентов каждой страны изолирован.

* **Отслеживание баланса:** Статус долга/кредита клиентов и операции взаимозачета на основе заказов выполняются через систему.

### 5.4. Управление продажами и заказами

Охватывает процесс от момента получения заказа до доставки.

* **Создание заказа:** Форма заказа, работающая по логике корзины, включая динамическое ценообразование.

* **Управление статусом:** Отслеживание рабочего процесса через статусы «В ожидании», «Подготавливается», «Отправлено», «Доставлено».

## 6. Живая демонстрация и Операционная проверка

Структура «Multi-Tenant» и возможности RBAC системы могут быть проверены в следующей реальной среде. Эти данные для доступа доказывают способность системы к изоляции и работоспособность модулей.

**URL проекта:** [https://app-tekstil.acrtech.com.tr](https://app-tekstil.acrtech.com.tr)

Учетные записи администраторов, определенные для тестирования системы с изолированными привилегиями:

| Регион операции | Имя пользователя | Пароль | Область доступа |
| :--- | :--- | :--- | :--- |
| **Операция Турция** | `admin.tr` | `admin` | Только продукты и текущие счета TR. |
| **Операция Россия** | `admin.ru` | `admin` | Только логистика и запасы RU. |
| **Операция Дубай** | `admin.du` | `admin` | Данные рынка Ближнего Востока. |

> **Примечание:** При входе под каждым пользователем, хотя модули в левом меню выглядят одинаково, будет видно, что данные внутри (Список продуктов, Список клиентов) совершенно разные.

## 7. Заключение

Проект AJ International — это современное решение SaaS со структурой RBAC, которая не ставит под угрозу безопасность, высокопроизводительным интерфейсом Next.js и гибкой архитектурой базы данных MongoDB.

Система в настоящее время активно обслуживает не просто как среда записи данных, а как интегрированная платформа, где принимаются операционные решения, и изоляция данных между регионами обеспечивается с математической точностью.