---
title: "FidanYS: هندسة تخطيط موارد المؤسسات الزراعية متعددة المستأجرين والمحمية من التضخم"
category: "SaaS & AgTech Architecture"
description: "مراجعة فنية لنظام الإدارة المستند إلى السحابة الذي تم تطويره باستخدام Next.js 15 وSpring Boot وMongoDB لعمليات إنتاج الشتلات، ومتكامل مع محاسبة التضخم. تفاصيل الوصول أدناه."
date: "2025-12-14"
image: "/portfolio/fidan.png"
author: "مهندس النظام"
---

# التخطيط المتكامل للموارد للزراعة الحديثة: التحليل الفني لـ FidanYS

**المشروع:** نظام إدارة المشاتل (FidanYS)

**رابط الوصول:** [app-fidanys.acrtech.com.tr](https://app-fidanys.acrtech.com.tr)

**نوع الوثيقة:** تحليل الهندسة الفنية ومقدمة النظام

## ملخص (Abstract)

تغطي هذه المراجعة الفنية مشروع **FidanYS**، المصمم لإدارة هياكل المخزون المعقدة (المخزون الحي) والعمليات المالية للشركات العاملة في إنتاج الشتلات وتجارتها.

بينما يحل تتبع "المنتجات الحية"، حيث تفشل برامج تخطيط موارد المؤسسات القياسية، باستخدام **Spring Boot** وهيكل المخطط المرن لـ **MongoDB**؛ فإنه يوفر تجربة مستخدم عالية الأداء مع **Next.js 15**. السمة الأكثر تميزًا للمشروع هي وحدة الذكاء المالي التي تحمي الشركات من تآكل رأس المال من خلال تطبيق **محاسبة التضخم** عبر تكامل CBRT (البنك المركزي).

## 1. المقدمة ومجال المشكلة

لا يمكن إدارة الإنتاج الزراعي، وخاصة زراعة الشتلات، بمنطق مخزون التجارة الإلكترونية أو التجزئة القياسي. العقبات الرئيسية أمام الرقمنة في القطاع هي:

1.  **هوية المنتج المركبة:** لا يمكن تعريف الشتلة برمز SKU واحد. مزيج من 6 معلمات مختلفة مثل النوع، والصنف، والأصل، والحجم، والعمر، وحالة الوعاء يشكل هوية المنتج.
2.  **عمليات الإنتاج:** يجب أن تنعكس المصاريف (العمالة، الأسمدة) المتكبدة خلال عملية تتراوح من سنة إلى 3 سنوات من البذور إلى تكوين الشتلة بشكل صحيح في تكلفة المنتج النهائي.
3.  **عدم اليقين الاقتصادي:** في بيئات التضخم المرتفع، يؤدي بيع منتج تم إنتاجه قبل أشهر بتكلفته التاريخية إلى تكبد الشركة خسارة.

FidanYS هو حل SaaS (البرمجيات كخدمة) تم تطويره بمبادئ "Domain-Driven Design" (التصميم الموجه للمجال) لحل هذه المشاكل.

## 2. مكدس التكنولوجيا وهندسة النظام

تم هيكلة النظام في هيكل **Full-Stack** وشبيه بـ **Monorepo** (العميل والخادم منفصلان ولكن متكاملان) لتلبية متطلبات قابلية التوسع والأمان.

### 2.1. هندسة الواجهة الأمامية (العميل)

تعمل واجهة المستخدم على **Next.js 15 (App Router)**، وهي أحدث إصدار من معايير الويب الحديثة.

* **أمان النوع:** تم تطوير المشروع بنسبة 100٪ باستخدام **TypeScript**، مما يقلل من أخطاء وقت التشغيل.
* **مكتبة واجهة المستخدم:** يتم توفير واجهة سريعة الاستجابة ويمكن الوصول إليها مع دعم السمات (الوضع الداكن/الفاتح) باستخدام **Material UI (MUI v7)**.
* **الحالة وذاكرة التخزين المؤقت:** يتم استخدام مكتبة **SWR (Stale-While-Revalidate)** لإدارة البيانات. تضمن هذه الاستراتيجية رؤية المستخدم للبيانات على الفور (ذاكرة التخزين المؤقت) أثناء التحقق من حداثة البيانات في الخلفية.
* **التحقق من صحة النموذج:** يتم التحقق من صحة إدخالات البيانات المعقدة على كل من جانب العميل والخادم باستخدام مخططات **React Hook Form** و **Zod**.

### 2.2. هندسة الواجهة الخلفية (الخادم)

تم بناء طبقة منطق العمل على **Spring Boot 3.x (Java 17+)**، وهو معيار موثوقية المؤسسة.

* **خيار قاعدة البيانات: MongoDB (NoSQL).**
    * *لماذا NoSQL؟* سمات الشتلات متغيرة. بدلاً من هيكل الجدول الجامد لـ SQL، يتم تخزين ميزات المنتج ككائنات ديناميكية ومضمنة باستخدام الهيكل المستند إلى المستندات لـ MongoDB.
* **استراتيجية واجهة برمجة التطبيقات (API):** تم إنشاء بنية API موجهة للموارد ومتوافقة تمامًا مع معايير **RESTful**.
* **تكامل الخدمات الخارجية:** تتدفق بيانات التضخم اليومية وأسعار الصرف تلقائيًا إلى النظام عبر اتصال آمن تم إنشاؤه مع خدمة CBRT EVDS API.

## 3. هندسة متعددة المستأجرين (Multi-Tenancy)

يوجد FidanYS في نموذج "البرمجيات كخدمة" حيث تخدم نسخة تطبيق واحدة شركات متعددة.

* **عزل المستأجر:** كل وثيقة مهمة (طلب، مخزون، حساب جاري، إلخ) في قاعدة البيانات لها حقل `tenantId`.
* **التصفية التلقائية:** تحدد المعترضات التي تعمل على مستوى Spring Data/Security في طبقة الواجهة الخلفية الشركة (المستأجر) التي يأتي منها الطلب الوارد.
    * يتم قراءة معلومات `tenantId` داخل `AuthenticationService` و JWT.
    * تتم إضافة المعيار `{ tenantId: "active_tenant" }` تلقائيًا إلى جميع استعلامات قاعدة البيانات.
    * تجعل هذه الهندسة من المستحيل رياضيًا رؤية بيانات الشركة (أ) من قبل الشركة (ب).

## 4. الوحدات الوظيفية الحرجة

الوحدات الرئيسية التي تميز النظام عن منافسيه هي:

### 4.1. إدارة المخزون الذكي والتنويعات
المنتجات في النظام ليست صفوفًا بسيطة. يعمل بمنطق "عائلة المنتج" و "التنويعات".
* **مصفوفة التنويعات:** عندما يختار المستخدمون نوع "الجوز"، على سبيل المثال، يقدم النظام تلقائيًا الأصناف الممكنة (تشاندلر، فيرنور) والأحجام كمصفوفة.
* **التتبع القائم على الموقع:** يتم مراقبة القطعة أو المستودع الذي توجد فيه الشتلة على الفور.

### 4.2. محاسبة التضخم والذكاء المالي
هذه هي الطبقة الأكثر تقنية واستراتيجية في المشروع.
* **التقييم الحقيقي:** يحسب `InflationService` القيمة "الحقيقية" الحالية لمصروف تم إنفاقه في الماضي.
* **تحليل التكلفة:** عند تحديد سعر بيع الشتلة، يقترح النظام "سعر حماية رأس المال" عن طريق إضافة ليس فقط سعر الشراء في الفاتورة ولكن أيضًا معدل التضخم الذي حدث من ذلك التاريخ حتى الوقت الحاضر إلى التكلفة.

### 4.3. دفعات الإنتاج (Batches)
يتم التتبع على أساس "الدفعة" وفقًا لطبيعة الإنتاج الزراعي.
* يتم إنشاء `ProductionBatch` عند بذر البذور.
* يتم جمع جميع تكاليف التسميد والري لتلك الدفعة في `CostPool`.
* عندما يحين وقت الحصاد، يتم تقسيم التكلفة الإجمالية في المجموعة على عدد الشتلات المنتجة لحساب **تكلة الوحدة الحقيقية**.

## 5. الأمان والتفويض

يتم توفير أمان التطبيق بمبدأ "الدفاع في العمق".

* **المصادقة:** مصادقة عديمة الحالة تعتمد على JWT (JSON Web Token).
* **التشفير:** يتم تخزين كلمات مرور المستخدم مجزأة باستخدام خوارزمية **BCrypt**.
* **RBAC (التحكم في الوصول القائم على الأدوار):**
    * `ADMIN`: لديه كل الصلاحيات.
    * `SALES`: يمكنه رؤية الطلبات والحسابات الجارية فقط، ولا يمكنه رؤية التكاليف.
    * `WAREHOUSE`: يمكنه فقط إجراء دخول وخروج المخزون، ولا يمكنه رؤية القيم النقدية.
* **جلسة واحدة:** عندما يقوم مستخدم بتسجيل الدخول من جهاز مختلف، يتم إنهاء جلسته القديمة للأمان (آلية `forceLogin`).

## 6. النظام المباشر والوصول

من الممكن اختبار بنية النظام وهيكل البيانات وقدرات إعداد التقارير المالية في بيئة حية.

| رابط الوصول | اسم المستخدم | كلمة المرور | ملاحظة |
| :--- | :--- | :--- | :--- |
| **[https://app-fidanys.acrtech.com.tr](https://app-fidanys.acrtech.com.tr/auth/sign-in)** | `admin` | `admin` | حساب تجريبي بصلاحية كاملة. |

*تعتبر المعاملات التي تتم في البيئة التجريبية بيانات اختبار ويمكن إعادة تعيينها بشكل دوري.*

## 7. الخاتمة

يقدم FidanYS حلاً دقيقًا لحاجة القطاع الزراعي إلى "التحول الرقمي" من خلال الجمع بين استقرار نظام Java البيئي وحداثة Next.js. خاصة مع وحدة **محاسبة التضخم**، فقد تجاوز كونه مجرد برنامج لتتبع المخزون وتحول إلى نظام دعم اتخاذ قرار استراتيجي لأصحاب الأعمال.